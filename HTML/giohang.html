<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gio Hang</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/giohang.css">
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
      integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm"
      crossorigin="anonymous"
    />
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="../js/giohang.js"></script>
    <script src="../JS/jquery-3.6.4.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    
 
</head>
<body>
    <header>
        <div class="container">
            <div class="row">
                <div class="col-1"><a href="../Trangchu.html" onclick="goBack()" class="btn btn-light">
                    <span class="button-icon">
                        <i class="fa fa-arrow-left"></i>
                    </span></a></div>
                <div class="col-11"><h1>
                    <span class="button-icon">
                         <i class="fa fa-cart-plus"></i>
                    </span>Giỏ hàng</h1></div>
            </div>
        </div>
    </header>
  
    <main>
        <div class="container-fluid">
            <div class="table-responsive">
                <table class="table table-striped" id="tableGH">
                    <thead>
                        <tr>
                          <th>STT</th>
                          <th>Tên món</th>
                          <th>Đơn giá</th>
                          <th>Số lượng</th>
                          <th>Thành tiền</th>
                          <th>Xóa</th>
                        </tr>
                    </thead>
                    <tbody >
                          
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="4">Tổng tiền</td>
                            <td id="TongTien"></td> 
                            <td></td>                         
                        </tr>

                    </tfoot>
                    
                </table>
            </div>
        </div>
        <div id="div1">
            
                <a class="btn" style="background-color: #072022; color: aliceblue;" href="../html/thanhtoan.html">Thanh toán</a>
          
        </div>
    </main>
    <div class="footer pt-5">
        <div class="footer text-white pt-5 pb-4" style="background-color: #072022">
            <div class="container">
              <div class="row text-start">
                <div class="col-md-3 ms-5">
                  <h4 class="text">SEA FOOD</h4>
                  <p>
                    <i class="fa fa-home"></i>
                    <span><i> Mở cửa 06:30 - 22:00 giờ mỗi ngày</i></span><br />
                    <i class="fa fa-map-marker"></i>
                    <span><i> 12 Nguyễn Văn Bảo, P.4, Quận Gò Vấp, TP.HCM</i></span><br />
                    <i class="fa fa-phone"></i>
                    <span><i> +84 245 4483</i></span><br />
                    <i class="fa fa-envelope"></i
                    ><span><i> <a href = "mailto: seafood@gmail.com">seafood@gmail.com</a></i></span><br />
                    <i class="fab fa-facebook"></i>
                    <i class="fab fa-instagram"></i>
                  </p>
                </div>
      
                <div class="col-md-3 ms-5">
                  <h4 class="text">MÓN NGON MỖI NGÀY</h4>
                  <ul class="list-group">
                    <li class="list-inline-item">
                      <a href="" class="text-white" style="text-decoration: none" title="GỎI NGÓ SEN TÔM MỰC"
                        >GỎI NGÓ SEN TÔM MỰC</a>
                    </li>
                    <li class="list-inline-item">
                      <a href="" class="text-white" style="text-decoration: none" title="SALAD CÁ NGỪ"
                        >SALAD CÁ NGỪ</a>
                    </li>
                    <li class="list-inline-item">
                      <a href="" class="text-white" style="text-decoration: none" title="SOUP HẢI SẢN TUYẾT YẾN"
                        >SOUP HẢI SẢN TUYẾT YẾN</a>
                    </li>
                    <li class="list-inline-item">
                      <a href="" class="text-white" style="text-decoration: none" title="HÀU NƯỚNG MUỐI ỚT"
                        >HÀU NƯỚNG MUỐI ỚT</a>
                    </li>
                  </ul>
                </div>
      
                <div class="col-md-3 ms-5">
                  <h4 class="text">LIÊN KẾT NHANH</h4>
                  <ul class="list-group ">
                    <li class="list-inline-item">
                      <a href="../HTML/Trangchu.html" class="text-white" style="text-decoration: none" title="Trang chủ"
                        >Trang chủ</a>
                    </li>
                    <li class="list-inline-item">
                      <a href="#intro" class="text-white" style="text-decoration: none" title="Giới thiệu"
                        >Giới thiệu</a>
                    </li>
                    <li class="list-inline-item">
                      <a href="" class="text-white" style="text-decoration: none" title="Đặt bàn"
                        >Đặt bàn</a>
                    </li>
                    <li class="list-inline-item">
                      <a href="" class="text-white" style="text-decoration: none" title="Giỏ hàng"
                        >Giỏ hàng</a>
                    </li>
                    <li class="list-inline-item">
                      <a href="../HTML/ThucDon_Lau_BS.html" class="text-white" style="text-decoration: none" title="Thực đơn"
                        >Thực đơn</a>
                    </li>
                  </ul>
                </div>
              </div>
              <hr>
              <div class="row text-lg-center">
                  <div class="col-sm-12 col-xs-12">
                      <b><p>&copy; 2023 -<span>&nbsp;Seafood</span></p></b>
                      <p>Nhóm phát triển: nhóm 15</p>
                      <p><i>Thành viên: Đào Hoa Anh Thư, Đỗ Nguyễn Quỳnh Hương, Trần Thu Huyền, Trần Cao Kiệt, Nguyễn Thanh Thùy Trang</i> </p>
                  </div>
              </div>
            </div>
            </div>
    </div>
    <script>
          $(document).ready(function () {
            // Lấy giỏ hàng từ localStorage
            var carts = JSON.parse(localStorage.getItem('Carts'));

            // Thêm dữ liệu món ăn vào localStorage
            function addToCart(item) {
                var cartKey = "cart" + Object.keys(carts).length; // Tạo key duy nhất cho món ăn mới
                carts[cartKey] = [item];
                localStorage.setItem('Carts', JSON.stringify(carts));
            }
            // Thực hiện vòng lặp lấy đối tượng trong carts
            var tongtien=0;
            Object.keys(carts).forEach(function (cartKey) {
                var cartItem = carts[cartKey][0];
                var gia = parseFloat(cartItem.price);
                var tenMon = cartItem.name;
                var soLuong = parseInt(cartItem.quantity);
                var thanhTien = gia * soLuong;
                tongtien=tongtien+thanhTien;
                // Tạo một hàng mới
                var newRow = $('<tr>');

                // Tạo các ô trong hàng mới
                $('<td>').html(cartKey.replace("cart", "")).appendTo(newRow); // Số thứ tự tự động tăng
                $('<td>').html(tenMon).appendTo(newRow);
                $('<td>').html(gia).appendTo(newRow);
                $('<td>').html(soLuong).appendTo(newRow);
                $('<td>').html(thanhTien).appendTo(newRow);

                // Tạo nút xóa
                var deleteButton = $('<button>')
                    .addClass('delete-button')
                    .html('<i class="fas fa-trash-alt"></i>')
                    .on('click', function () {
                    Xoa(cartKey); 
                       
                });
                // Tạo ô Xóa và thêm nút vào ô
                $('<td>').append(deleteButton).appendTo(newRow);
                // Thêm hàng mới vào tbody
                $('#tableGH tbody').append(newRow);
            });
            function Xoa(cartKey) {
                    var cartItem = carts[cartKey][0];
                    var soLuong = parseInt(cartItem.quantity);
                    var gia = parseFloat(cartItem.price);
                    var thanhTien = gia * soLuong;

                    delete carts[cartKey];
                    localStorage.setItem('Carts', JSON.stringify(carts));

                    var cartv = localStorage.getItem("cartv");
                    cartv = cartv - soLuong;
                    localStorage.setItem('cartv', cartv);

                    var row = $('#tableGH tbody tr:has(td:contains(' + cartKey.replace("cart", "") + '))');
                    row.remove();

                    tongtien -= thanhTien; 
                    $("#TongTien").text(tongtien.toFixed()); 
}

            $("#TongTien").text(tongtien)
            
    });   
   
</script>


</body>
</html>
